<section>
    <template v-if="state.loading">
        Loading...
    </template>
    <template v-else-if="state.loadingError">
        Unable to load todos...
    </template>
    <template v-else>
        <h1>{{ 'todolist:welcome' | f-m-i18n }} - {{state.todolist.todolistName }}</h1>

        <m-button @click="$emit('open-new-form', state)">Nouvelle t√¢che</m-button>

        <m-table :columns="columns"
                 :rows="state.visibleTodos">

            <template slot="body.dueDate"
                      slot-scope="{ data }">
                <span v-html="$options.filters.formatDate(data.dueDate)"></span>
            </template>

            <template slot="body.status"
                      slot-scope="{ data }">
                <m-i18n :k="'todolist:status-' + data.status"></m-i18n>
            </template>

            <template slot="body.todolistId"
                      slot-scope="{ data }">
                <m-option>
                    <m-option-item-edit></m-option-item-edit>
                    <m-option-item-delete @click="$emit('delete-todo', data)"></m-option-item-delete>
                </m-option>
            </template>
        </m-table>
    </template>

    <todolist-form v-if="state.todolistFormState.open"
                   :state="state.todolistFormState"
                   v-on="$listeners"></todolist-form>
</section>
